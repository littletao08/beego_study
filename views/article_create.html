{{template "public/header.html" .}}
<link href="../static/css/bootstrap-markdown-editor.css" rel="stylesheet">


<div class="col-md-9" role="main">
    <div id="editor"></div>
    <!--<button class="md-btn btn btn-sm btn-default btn-preview" id="save">save</button>-->
    <script type="text/javascript">
        $(function () {
            $("#editor").markdownEditor(
                {
                    preview: true,
                    onPreview: function (content, callback) {
                        callback(marked(content));
                    },
                    onSave: function (content) {
                        var content = marked(content);
                        if (!$.trim(content)) {
                            $(".md-editor").css("border", "1px solid red");
                            return;
                        }
                        $.post('/articles', {title: "go study", content: content},
                                function (data) {
                                    if (data) {
                                        alert("保存成功!");
                                        window.location.href = "/"
                                    } else {
                                        alert("保存失败!")
                                    }
                                }
                        )
                    }
                }
            );


            $("textarea").keyup(function () {
                var content = $('#editor').markdownEditor('content');
                if (null != content && content.length > 0) {
                    $(".md-editor").css("border", "");
                }else{
                    $(".md-editor").css("border", "1px solid red");
                }
            });

        });
    </script>
</div>
{{template "public/footer.html" .}}